name: ğŸš€ è‡ªåŠ¨éƒ¨ç½²ä¸ªäººç½‘ç«™

# ä»€ä¹ˆæ—¶å€™è§¦å‘éƒ¨ç½²
on:
  push:
    branches: [ main ]

# è®¾ç½®æƒé™
permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    # æ­¥éª¤1ï¼šè·å–ä»£ç 
    - name: ğŸ“¥ è·å–ç½‘ç«™ä»£ç 
      uses: actions/checkout@v4
      
    # æ­¥éª¤2ï¼šæ£€æŸ¥ç½‘ç«™æ–‡ä»¶
    - name: âœ… æ£€æŸ¥ç½‘ç«™æ–‡ä»¶
      run: |
        echo "ğŸ” æ£€æŸ¥ç½‘ç«™æ˜¯å¦å®Œæ•´..."
        
        if [ -f "index.html" ]; then
          echo "âœ… ä¸»é¡µæ–‡ä»¶å­˜åœ¨"
        else
          echo "âŒ æ‰¾ä¸åˆ°ä¸»é¡µæ–‡ä»¶"
          exit 1
        fi
        
        # æ£€æŸ¥HTMLåŸºæœ¬ç»“æ„
        if grep -q "<title>" index.html; then
          echo "âœ… ç½‘ç«™æœ‰æ ‡é¢˜"
        else
          echo "âš ï¸  å»ºè®®æ·»åŠ ç½‘ç«™æ ‡é¢˜"
        fi
        
        if grep -q "<h1>" index.html; then
          echo "âœ… ç½‘ç«™æœ‰ä¸»æ ‡é¢˜"
        else
          echo "âš ï¸  å»ºè®®æ·»åŠ ä¸»æ ‡é¢˜"
        fi
        
        echo "ğŸ‰ ç½‘ç«™æ£€æŸ¥å®Œæˆï¼"
    
    # æ­¥éª¤3ï¼šç½‘ç«™ç»Ÿè®¡ä¿¡æ¯
    - name: ğŸ“Š ç½‘ç«™ç»Ÿè®¡
      run: |
        echo "ğŸ“Š ç½‘ç«™æ„å»ºä¿¡æ¯ï¼š"
        echo "æ–‡ä»¶æ•°é‡ï¼š$(find . -name "*.html" -o -name "*.css" -o -name "*.js" | wc -l)"
        echo "HTMLè¡Œæ•°ï¼š$(wc -l < index.html)"
        echo "æ„å»ºæ—¶é—´ï¼š$(date)"
        echo "æäº¤ç‰ˆæœ¬ï¼š${GITHUB_SHA:0:8}"
        echo "æäº¤è€…ï¼š${{ github.actor }}"
    
    # æ­¥éª¤4ï¼šé…ç½®GitHub Pages
    - name: âš™ï¸ é…ç½®éƒ¨ç½²ç¯å¢ƒ
      uses: actions/configure-pages@v5
      
    # æ­¥éª¤5ï¼šæ‰“åŒ…ç½‘ç«™æ–‡ä»¶
    - name: ğŸ“¦ æ‰“åŒ…ç½‘ç«™
      uses: actions/upload-pages-artifact@v3
      with:
        path: ./
        
    # æ­¥éª¤6ï¼šéƒ¨ç½²åˆ°GitHub Pages
    - name: ğŸŒ å‘å¸ƒç½‘ç«™
      id: deployment
      uses: actions/deploy-pages@v4
      
    # æ­¥éª¤7ï¼šéƒ¨ç½²æˆåŠŸé€šçŸ¥
    - name: ğŸ‰ éƒ¨ç½²å®Œæˆ
      run: |
        echo "âœ… ç½‘ç«™éƒ¨ç½²æˆåŠŸï¼"
        echo "ğŸŒ è®¿é—®åœ°å€ï¼š${{ steps.deployment.outputs.page_url }}"
        echo "ğŸš€ ä½ çš„ç½‘ç«™ç°åœ¨å·²ç»åœ¨çº¿äº†ï¼"